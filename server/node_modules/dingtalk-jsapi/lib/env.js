"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getENV=exports.getUA=void 0;var sdk_1=require("./sdk"),sdk_2=require("./sdk");Object.defineProperty(exports,"ENV_ENUM",{enumerable:!0,get:function(){return sdk_2.ENV_ENUM}}),Object.defineProperty(exports,"APP_TYPE",{enumerable:!0,get:function(){return sdk_2.APP_TYPE}}),Object.defineProperty(exports,"ENV_ENUM_SUB",{enumerable:!0,get:function(){return sdk_2.ENV_ENUM_SUB}});var dingtalk_javascript_env_1=require("./packages/dingtalk-javascript-env"),getTopBridge=function(){try{if("undefined"!=typeof window&&void 0!==window.top){return window.top.__dingtalk_jsapi_top_platfrom_config__}}catch(e){return}},EDdWeexEnv;!function(e){e.singlePage="singlePage",e.miniApp="miniApp",e.miniWidget="miniWidget"}(EDdWeexEnv||(EDdWeexEnv={})),exports.getUA=function(){var e="";try{"undefined"!=typeof navigator&&(e=navigator&&(navigator.userAgent||navigator.swuserAgent)||"")}catch(t){e=""}return e},exports.getENV=function(){var e,t,n=exports.getUA(),i=/iPhone|iPad|iPod|iOS/i.test(n),d=/Android/i.test(n),a=/OpenHarmony/i.test(n)&&/ArkWeb/i.test(n),r=/DingTalk/i.test(n),o=/dd-web/i.test(n),_="object"==typeof nuva,s="object"==typeof dd&&"function"==typeof dd.dtBridge,E=/TaurusApp/.test(n),p=E&&!r,g=E&&r,l=p&&"undefined"!=typeof my&&null!==my&&void 0!==my.alert,u=E&&/dingtalk-win/.test(n),v=!u&&p&&i,f=!u&&p&&d,k=!u&&g&&i,c=!u&&g&&d,N=s&&i||_&&i,P=r||dingtalk_javascript_env_1.default.isDingTalk,A=i&&P||dingtalk_javascript_env_1.default.isWeexiOS||N,w=d&&P||dingtalk_javascript_env_1.default.isWeexAndroid,U=s,m=o,M=a&&P,y=sdk_1.APP_TYPE.WEB;if(l)y=sdk_1.APP_TYPE.MINI_APP;else if(m)y=sdk_1.APP_TYPE.WEBVIEW_IN_MINIAPP;else if(U)y=sdk_1.APP_TYPE.MINI_APP;else if(dingtalk_javascript_env_1.default.isWeexiOS||dingtalk_javascript_env_1.default.isWeexAndroid)try{var V=weex.config.ddWeexEnv;y=V===EDdWeexEnv.miniWidget?sdk_1.APP_TYPE.WEEX_WIDGET:sdk_1.APP_TYPE.WEEX}catch(e){y=sdk_1.APP_TYPE.WEEX}var x,W="*",T=n.match(/AliApp\(\w+\/([a-zA-Z0-9.-]+)\)/);null===T&&(T=n.match(/DingTalk\/([a-zA-Z0-9.-]+)/));var I;T&&T[1]&&(I=T[1]);var S="";"undefined"!=typeof name&&(S=name);var j=getTopBridge();try{j&&"undefined"!=typeof window&&void 0!==window.top&&window.top!==window&&(S=top.name)}catch(e){}if(S)try{var b=JSON.parse(S);b.hostVersion&&(I=b.hostVersion),W=b.language||navigator.language||"*",x=b.containerId}catch(e){}var h=!!x||"undefined"!=typeof window&&(null===(t=null===(e=null===window||void 0===window?void 0:window.dingtalk)||void 0===e?void 0:e.platform)||void 0===t?void 0:t.invokeAPI);h&&!I&&(T=n.match(/DingTalk\(([a-zA-Z0-9\.-]+)\)/))&&T[1]&&(I=T[1]);var B,O=sdk_1.ENV_ENUM_SUB.noSub;if(u?(B=sdk_1.ENV_ENUM.gdtPc,O=sdk_1.ENV_ENUM_SUB.win):B=v?sdk_1.ENV_ENUM.gdtIos:f?sdk_1.ENV_ENUM.gdtAndroid:k?sdk_1.ENV_ENUM.gdtStandardIos:c?sdk_1.ENV_ENUM.gdtStandardAndroid:A?sdk_1.ENV_ENUM.ios:w&&!M?sdk_1.ENV_ENUM.android:M?sdk_1.ENV_ENUM.harmony:h?sdk_1.ENV_ENUM.pc:j&&j.platform?j.platform:sdk_1.ENV_ENUM.notInDingTalk,B===sdk_1.ENV_ENUM.pc){O=n.indexOf("Macintosh; Intel Mac OS")>-1?sdk_1.ENV_ENUM_SUB.mac:sdk_1.ENV_ENUM_SUB.win}return{platform:B,platformSub:O,version:I,appType:y,language:W}};